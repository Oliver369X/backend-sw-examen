# Plataforma CASE - Generador Colaborativo de Backend

## ğŸ¯ Resumen Ejecutivo

**Plataforma de DiseÃ±o y GeneraciÃ³n de Backend Colaborativo** es una herramienta CASE web que permite a desarrolladores crear diagramas UML de clases de forma colaborativa y generar automÃ¡ticamente cÃ³digo Spring Boot completo y funcional.

### Propuesta de Valor
- **DiseÃ±o Visual**: Interface drag & drop para crear diagramas UML
- **ColaboraciÃ³n Real-time**: MÃºltiples desarrolladores trabajando simultÃ¡neamente
- **GeneraciÃ³n AutomÃ¡tica**: CÃ³digo Spring Boot completo desde UML
- **Asistencia IA**: Sugerencias inteligentes para optimizar el diseÃ±o
- **Lista para Usar**: Proyecto compilable con APIs REST y base de datos

---

## ğŸ—ï¸ Arquitectura del Backend (TypeScript/Node.js)

### Stack TecnolÃ³gico Principal
```
Framework: Express.js + TypeScript
Base de Datos: PostgreSQL + Prisma ORM
Tiempo Real: Socket.io
AutenticaciÃ³n: JWT
Cache: Redis
Templates: Handlebars
IA: OpenAI API
```

### MÃ³dulos del Sistema

#### 1. **AutenticaciÃ³n y Usuarios**
- Registro/Login con JWT
- GestiÃ³n de sesiones
- Middleware de autorizaciÃ³n
- Control de acceso por proyecto

#### 2. **GestiÃ³n de Proyectos**
- CRUD completo de proyectos
- InvitaciÃ³n a colaboradores
- Versionado de diagramas
- OrganizaciÃ³n por usuario

#### 3. **Motor UML**
- Parser/serializer de diagramas JSON
- ValidaciÃ³n de integridad del modelo
- Soporte para clases, atributos, relaciones
- ValidaciÃ³n de tipos de datos

#### 4. **ColaboraciÃ³n Tiempo Real**
- WebSocket rooms por proyecto
- SincronizaciÃ³n de cambios instantÃ¡nea
- Cursores de colaboradores
- ResoluciÃ³n de conflictos

#### 5. **Generador de CÃ³digo Spring Boot**
- Motor de templates Handlebars
- GeneraciÃ³n de entidades JPA
- Repositorios + Servicios + Controladores
- Estructura completa de proyecto Maven

#### 6. **Asistencia por IA**
- Sugerencias de atributos por nombre de clase
- ValidaciÃ³n semÃ¡ntica de relaciones
- Patrones de diseÃ±o recomendados
- OptimizaciÃ³n del modelo

---

## ğŸ“Š Modelo de Datos

### Entidades Principales

#### User
```typescript
interface User {
  id: string;
  email: string;
  username: string;
  password: string; // hasheado
  createdAt: Date;
  updatedAt: Date;
}
```

#### Project  
```typescript
interface Project {
  id: string;
  name: string;
  description?: string;
  ownerId: string;
  isCollaborative: boolean;
  createdAt: Date;
  updatedAt: Date;
}
```

#### UMLDiagram
```typescript
interface UMLDiagram {
  id: string;
  projectId: string;
  diagramData: {
    classes: UMLClass[];
    relationships: UMLRelationship[];
    metadata: DiagramMetadata;
  };
  version: number;
  updatedAt: Date;
}
```

#### UMLClass
```typescript
interface UMLClass {
  id: string;
  name: string;
  attributes: UMLAttribute[];
  position: { x: number; y: number };
  stereotype?: string;
}

interface UMLAttribute {
  name: string;
  type: string; // Java types: String, Integer, Long, etc.
  visibility: 'private' | 'public' | 'protected';
  isRequired: boolean;
  defaultValue?: string;
}
```

#### UMLRelationship  
```typescript
interface UMLRelationship {
  id: string;
  type: 'association' | 'inheritance' | 'composition' | 'aggregation';
  sourceClassId: string;
  targetClassId: string;
  cardinality: '1:1' | '1:N' | 'N:M';
  name?: string;
}
```

---

## ğŸ”Œ APIs Principales

### AutenticaciÃ³n
```
POST /api/auth/register     - Registro de usuario
POST /api/auth/login        - Login
POST /api/auth/logout       - Logout  
GET  /api/auth/me          - Info usuario actual
```

### Proyectos
```
POST   /api/projects                    - Crear proyecto
GET    /api/projects                    - Listar mis proyectos
GET    /api/projects/:id                - Obtener proyecto
PUT    /api/projects/:id                - Actualizar proyecto
DELETE /api/projects/:id                - Eliminar proyecto
POST   /api/projects/:id/invite         - Invitar colaborador
```

### Diagramas UML
```
GET /api/projects/:id/diagram           - Cargar diagrama
PUT /api/projects/:id/diagram           - Guardar diagrama
POST /api/projects/:id/diagram/validate - Validar modelo
GET /api/projects/:id/diagram/history   - Historial versiones
```

### GeneraciÃ³n de CÃ³digo
```
POST /api/projects/:id/generate/backend    - Generar Spring Boot
POST /api/projects/:id/generate/postman    - Generar colecciÃ³n Postman
GET  /api/projects/:id/download/:fileId    - Descargar archivos
```

### Asistencia IA
```
POST /api/projects/:id/ai/suggestions      - Sugerencias para clase
POST /api/projects/:id/ai/validate         - ValidaciÃ³n semÃ¡ntica
POST /api/projects/:id/ai/patterns         - Patrones recomendados
```

### WebSocket (ColaboraciÃ³n)
```
WS /api/collaborate/:projectId
Events:
- join_project    - Unirse a sesiÃ³n
- diagram_change  - Cambio en diagrama  
- cursor_move     - Movimiento cursor
- user_joined     - Usuario se uniÃ³
- user_left       - Usuario se fue
```

---

## âš™ï¸ Flujo de GeneraciÃ³n de CÃ³digo

### Input: Diagrama UML
```json
{
  "classes": [
    {
      "id": "user_001",
      "name": "User", 
      "attributes": [
        {"name": "id", "type": "Long", "visibility": "private"},
        {"name": "email", "type": "String", "visibility": "private"},
        {"name": "username", "type": "String", "visibility": "private"}
      ]
    },
    {
      "id": "post_001", 
      "name": "Post",
      "attributes": [
        {"name": "id", "type": "Long", "visibility": "private"},
        {"name": "title", "type": "String", "visibility": "private"},
        {"name": "content", "type": "String", "visibility": "private"}
      ]
    }
  ],
  "relationships": [
    {
      "type": "association",
      "sourceClassId": "user_001",
      "targetClassId": "post_001", 
      "cardinality": "1:N"
    }
  ]
}
```

### Output: Proyecto Spring Boot
```
generated-project/
â”œâ”€â”€ pom.xml
â”œâ”€â”€ src/main/java/com/generated/app/
â”‚   â”œâ”€â”€ Application.java
â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â”œâ”€â”€ User.java        (@Entity, @Table, @JPA annotations)
â”‚   â”‚   â””â”€â”€ Post.java        (con @ManyToOne hacia User)
â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â”œâ”€â”€ UserRepository.java  (extends JpaRepository)
â”‚   â”‚   â””â”€â”€ PostRepository.java
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”œâ”€â”€ UserService.java     (mÃ©todos CRUD + @Transactional)
â”‚   â”‚   â””â”€â”€ PostService.java
â”‚   â””â”€â”€ controller/
â”‚       â”œâ”€â”€ UserController.java  (@RestController con endpoints)
â”‚       â””â”€â”€ PostController.java
â””â”€â”€ src/main/resources/
    â””â”€â”€ application.properties   (config DB)
```

### Ejemplo: Entity Generada
```java
@Entity
@Table(name = "users")
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false, unique = true)
    private String email;
    
    @Column(nullable = false)
    private String username;
    
    @OneToMany(mappedBy = "user", cascade = CascadeType.ALL)
    private List<Post> posts;
    
    // Constructors, getters, setters...
}
```

---

## ğŸ”„ ColaboraciÃ³n en Tiempo Real

### Flujo de SincronizaciÃ³n
1. **Usuario A** mueve una clase en el diagrama
2. **Frontend** envÃ­a evento via WebSocket
3. **Backend** valida el cambio
4. **Backend** actualiza estado en memoria
5. **Backend** broadcast a todos los colaboradores  
6. **Otros usuarios** ven el cambio instantÃ¡neamente

### GestiÃ³n de Conflictos
- **Last Write Wins**: El Ãºltimo cambio prevalece
- **Element Locking**: Bloqueo temporal al editar propiedades
- **Change Queue**: Cola de cambios para procesar en orden

---

## ğŸ¤– IntegraciÃ³n con IA

### Funcionalidades IA
1. **Sugerencias de Atributos**
   - Input: "User" â†’ Sugiere: id, email, username, password, createdAt
   
2. **ValidaciÃ³n SemÃ¡ntica**
   - Detecta relaciones faltantes obvias
   - Sugiere tipos de datos apropiados
   
3. **Patrones de DiseÃ±o**
   - Identifica oportunidades para Repository, Factory, etc.

### Rate Limiting y Cache
- **15 requests/15min** por usuario para IA
- **Cache Redis** para respuestas similares  
- **Fallback** a sugerencias por defecto si IA falla

---

## ğŸ“ Estructura del Proyecto Backend

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/          # Endpoints REST
â”‚   â”‚   â”œâ”€â”€ AuthController.ts
â”‚   â”‚   â”œâ”€â”€ ProjectController.ts
â”‚   â”‚   â”œâ”€â”€ DiagramController.ts  
â”‚   â”‚   â”œâ”€â”€ GenerationController.ts
â”‚   â”‚   â””â”€â”€ AIController.ts
â”‚   â”œâ”€â”€ services/            # LÃ³gica de negocio
â”‚   â”‚   â”œâ”€â”€ AuthService.ts
â”‚   â”‚   â”œâ”€â”€ ProjectService.ts
â”‚   â”‚   â”œâ”€â”€ DiagramService.ts
â”‚   â”‚   â”œâ”€â”€ CodeGenerationService.ts
â”‚   â”‚   â”œâ”€â”€ CollaborationService.ts  
â”‚   â”‚   â””â”€â”€ AIService.ts
â”‚   â”œâ”€â”€ models/              # Prisma schema
â”‚   â”‚   â””â”€â”€ schema.prisma
â”‚   â”œâ”€â”€ generators/          # Motor generaciÃ³n cÃ³digo
â”‚   â”‚   â”œâ”€â”€ SpringBootGenerator.ts
â”‚   â”‚   â”œâ”€â”€ PostmanGenerator.ts
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â”œâ”€â”€ entity.hbs
â”‚   â”‚       â”œâ”€â”€ repository.hbs
â”‚   â”‚       â”œâ”€â”€ service.hbs
â”‚   â”‚       â””â”€â”€ controller.hbs
â”‚   â”œâ”€â”€ websocket/          # ColaboraciÃ³n tiempo real
â”‚   â”‚   â”œâ”€â”€ CollaborationSocket.ts
â”‚   â”‚   â””â”€â”€ SocketMiddleware.ts  
â”‚   â”œâ”€â”€ middleware/         # Middlewares Express
â”‚   â”‚   â”œâ”€â”€ AuthMiddleware.ts
â”‚   â”‚   â”œâ”€â”€ ValidationMiddleware.ts
â”‚   â”‚   â””â”€â”€ ErrorMiddleware.ts
â”‚   â”œâ”€â”€ types/             # TypeScript definitions  
â”‚   â”‚   â”œâ”€â”€ auth.types.ts
â”‚   â”‚   â”œâ”€â”€ project.types.ts
â”‚   â”‚   â”œâ”€â”€ diagram.types.ts
â”‚   â”‚   â””â”€â”€ generation.types.ts
â”‚   â”œâ”€â”€ utils/             # Utilidades
â”‚   â”‚   â”œâ”€â”€ JwtUtils.ts
â”‚   â”‚   â”œâ”€â”€ ValidationUtils.ts
â”‚   â”‚   â””â”€â”€ FileUtils.ts
â”‚   â””â”€â”€ config/           # Configuraciones
â”‚       â”œâ”€â”€ database.ts
â”‚       â”œâ”€â”€ redis.ts  
â”‚       â””â”€â”€ socket.ts
â”œâ”€â”€ tests/               # Tests unitarios/integraciÃ³n
â”œâ”€â”€ docs/                # DocumentaciÃ³n API
â”œâ”€â”€ docker-compose.yml   # PostgreSQL + Redis
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

---

## ğŸš€ Casos de Uso Principales

### CU1: Crear Proyecto
1. Usuario autenticado crea nuevo proyecto
2. Sistema genera proyecto vacÃ­o
3. Usuario puede invitar colaboradores
4. Se crea room de WebSocket para colaboraciÃ³n

### CU2: DiseÃ±ar Diagrama  
1. Usuario abre lienzo de diseÃ±o
2. Arrastra clases desde paleta de herramientas
3. Define atributos y tipos de datos
4. Crea relaciones entre clases
5. Sistema valida en tiempo real

### CU3: Colaborar en Tiempo Real
1. MÃºltiples usuarios en mismo proyecto
2. Cambios se sincronizan instantÃ¡neamente  
3. Cursores y selecciones visibles
4. Chat/comentarios opcionales

### CU4: Generar CÃ³digo
1. Usuario completa diseÃ±o UML
2. Configura opciones de generaciÃ³n (package, DB, etc.)
3. Sistema procesa diagrama con templates
4. Genera proyecto Spring Boot completo
5. Usuario descarga ZIP con cÃ³digo

### CU5: Asistencia IA
1. Usuario crea clase "Product"
2. IA sugiere atributos: id, name, price, description
3. Usuario acepta/modifica sugerencias  
4. IA valida relaciones y sugiere optimizaciones

---

## ğŸ”§ ConfiguraciÃ³n y Deployment

### Variables de Entorno
```bash
# Base de datos
DATABASE_URL=postgresql://user:pass@localhost:5432/casedb

# JWT
JWT_SECRET=your-super-secret-key
JWT_EXPIRES_IN=7d

# Redis  
REDIS_URL=redis://localhost:6379

# IA
OPENAI_API_KEY=sk-your-openai-key

# App
PORT=3000
NODE_ENV=production
```

### Docker Compose
```yaml
services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: casedb
      POSTGRES_USER: caseuser
      POSTGRES_PASSWORD: casepass
    ports:
      - "5432:5432"
      
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
      
  app:
    build: .
    ports:
      - "3000:3000"
    depends_on:
      - postgres  
      - redis
```

---

## ğŸ“ˆ MÃ©tricas y Monitoreo

### KPIs del Sistema
- **Proyectos creados** por dÃ­a/semana
- **CÃ³digo generado** (lÃ­neas, archivos)  
- **Sesiones colaborativas** activas
- **Consultas IA** realizadas
- **Tiempo promedio** de generaciÃ³n

### Health Checks
```
GET /api/health
- Database connection
- Redis connection  
- IA API status
- File system space
```

---

## ğŸ¯ Roadmap Futuro

### Fase 1: MVP (Actual)
âœ… AutenticaciÃ³n bÃ¡sica  
âœ… CRUD proyectos
âœ… Editor UML drag & drop
âœ… GeneraciÃ³n Spring Boot
âœ… ColaboraciÃ³n tiempo real
âœ… Asistencia IA bÃ¡sica

### Fase 2: Mejoras
- MÃºltiples tipos de diagramas (Secuencia, Casos de Uso)
- Templates personalizables  
- IntegraciÃ³n con Git
- Export a diferentes formatos

### Fase 3: Enterprise
- SSO/LDAP integration
- Roles y permisos granulares
- MÃ©tricas avanzadas
- API rate limiting por usuario

---

Este proyecto combina **diseÃ±o visual**, **colaboraciÃ³n moderna** y **automatizaciÃ³n inteligente** para revolucionar cÃ³mo los desarrolladores crean backends, reduciendo el tiempo de setup inicial de dÃ­as a minutos.